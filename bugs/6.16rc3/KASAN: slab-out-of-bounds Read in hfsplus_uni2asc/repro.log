Warning: Permanently added '[localhost]:39553' (ED25519) to the list of known hosts.
executing program
syzkaller login: [  127.798469][ T9729] loop0: detected capacity change from 0 to 1024
[  127.839526][ T9729] ==================================================================
[  127.840817][ T9729] BUG: KASAN: slab-out-of-bounds in hfsplus_uni2asc+0x92a/0xa20
[  127.842098][ T9729] Read of size 2 at addr ffff88804515c40c by task syz-executor195/9729
[  127.843352][ T9729] 
[  127.844192][ T9729] CPU: 1 UID: 0 PID: 9729 Comm: syz-executor195 Not tainted 6.16.0-rc3 #1 PREEMPT(full) 
[  127.844225][ T9729] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.2-debian-1.16.2-1 04/01/2014
[  127.844251][ T9729] Call Trace:
[  127.844262][ T9729]  <TASK>
[  127.844272][ T9729]  dump_stack_lvl+0x116/0x1b0
[  127.846030][ T9729]  print_report+0xcd/0x640
[  127.846057][ T9729]  ? __phys_addr+0xee/0x170
[  127.846098][ T9729]  ? hfsplus_uni2asc+0x92a/0xa20
[  127.846133][ T9729]  ? __pfx_uni2char+0x10/0x10
[  127.847964][ T9729]  kasan_report+0x96/0xd0
[  127.847991][ T9729]  ? hfsplus_uni2asc+0x92a/0xa20
[  127.848030][ T9729]  hfsplus_uni2asc+0x92a/0xa20
[  127.848071][ T9729]  hfsplus_readdir+0x9ba/0xfe0
[  127.848104][ T9729]  ? __pfx_hfsplus_readdir+0x10/0x10
[  127.848163][ T9729]  ? down_read_killable+0x14e/0x4e0
[  127.848192][ T9729]  ? __pfx_down_read_killable+0x10/0x10
[  127.848218][ T9729]  ? __sanitizer_cov_trace_pc+0x20/0x50
[  127.848249][ T9729]  ? common_file_perm+0x29e/0x3f0
[  127.848285][ T9729]  ? write_comp_data+0x29/0x80
[  127.848314][ T9729]  iterate_dir+0x297/0xae0
[  127.848354][ T9729]  ? __sanitizer_cov_trace_pc+0x20/0x50
[  127.848384][ T9729]  __x64_sys_getdents64+0x12f/0x2b0
[  127.848424][ T9729]  ? __pfx___x64_sys_getdents64+0x10/0x10
[  127.848465][ T9729]  ? __pfx_filldir64+0x10/0x10
[  127.848503][ T9729]  ? irqentry_exit_to_user_mode+0xae/0x290
[  127.848546][ T9729]  ? do_syscall_64+0x95/0x490
[  127.848590][ T9729]  do_syscall_64+0xcf/0x490
[  127.848632][ T9729]  entry_SYSCALL_64_after_hwframe+0x77/0x7f
[  127.848661][ T9729] RIP: 0033:0x7fe235543f19
[  127.848691][ T9729] Code: 28 00 00 00 75 05 48 83 c4 28 c3 e8 01 18 00 00 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
[  127.848718][ T9729] RSP: 002b:00007ffdb9cf8788 EFLAGS: 00000246 ORIG_RAX: 00000000000000d9
[  127.848744][ T9729] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007fe235543f19
[  127.848761][ T9729] RDX: 0000000000000400 RSI: 00002000000063c0 RDI: 0000000000000004
[  127.848778][ T9729] RBP: 00007fe2355b8510 R08: 000055558cfab4d0 R09: 000055558cfab4d0
[  127.848795][ T9729] R10: 0000000000000002 R11: 0000000000000246 R12: 00007ffdb9cf87b0
[  127.848811][ T9729] R13: 0000000000000001 R14: 431bde82d7b634db R15: 00007fe23558d03b
[  127.848837][ T9729]  </TASK>
[  127.848847][ T9729] 
[  127.883215][ T9729] Allocated by task 9729:
[  127.883894][ T9729]  kasan_save_stack+0x20/0x40
[  127.884662][ T9729]  kasan_save_track+0x14/0x30
[  127.885461][ T9729]  __kasan_kmalloc+0xaa/0xb0
[  127.886219][ T9729]  __kmalloc_noprof+0x23a/0x510
[  127.886992][ T9729]  hfsplus_find_init+0x95/0x1f0
[  127.887769][ T9729]  hfsplus_readdir+0x204/0xfe0
[  127.888546][ T9729]  iterate_dir+0x297/0xae0
[  127.889302][ T9729]  __x64_sys_getdents64+0x12f/0x2b0
[  127.890175][ T9729]  do_syscall_64+0xcf/0x490
[  127.890920][ T9729]  entry_SYSCALL_64_after_hwframe+0x77/0x7f
[  127.891889][ T9729] 
[  127.892280][ T9729] The buggy address belongs to the object at ffff88804515c000
[  127.892280][ T9729]  which belongs to the cache kmalloc-2k of size 2048
[  127.894372][ T9729] The buggy address is located 0 bytes to the right of
[  127.894372][ T9729]  allocated 1036-byte region [ffff88804515c000, ffff88804515c40c)
[  127.896571][ T9729] 
[  127.896988][ T9729] The buggy address belongs to the physical page:
[  127.897995][ T9729] page: refcount:0 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x45158
[  127.899327][ T9729] head: order:3 mapcount:0 entire_mapcount:0 nr_pages_mapped:0 pincount:0
[  127.900791][ T9729] flags: 0x4fff00000000040(head|node=1|zone=1|lastcpupid=0x7ff)
[  127.902070][ T9729] page_type: f5(slab)
[  127.902719][ T9729] raw: 04fff00000000040 ffff88801b442000 dead000000000100 dead000000000122
[  127.904053][ T9729] raw: 0000000000000000 0000000080080008 00000000f5000000 0000000000000000
[  127.905354][ T9729] head: 04fff00000000040 ffff88801b442000 dead000000000100 dead000000000122
[  127.906652][ T9729] head: 0000000000000000 0000000080080008 00000000f5000000 0000000000000000
[  127.907950][ T9729] head: 04fff00000000003 ffffea0001145601 00000000ffffffff 00000000ffffffff
[  127.909334][ T9729] head: ffffffffffffffff 0000000000000000 00000000ffffffff 0000000000000008
[  127.910752][ T9729] page dumped because: kasan: bad access detected
[  127.911738][ T9729] page_owner tracks the page as allocated
[  127.912648][ T9729] page last allocated via order 3, migratetype Unmovable, gfp_mask 0xd20c0(__GFP_IO|__GFP_FS|__GFP_NOWARN|__GFP_NORETRY|__GFP_COMP|__GFP_NOMEMALLOC), pid 793, tgid 793 (kworker/1:2), ts 117735797427, free_ts 117347364170
[  127.915941][ T9729]  post_alloc_hook+0x146/0x160
[  127.916705][ T9729]  prep_new_page+0x16/0x70
[  127.917428][ T9729]  get_page_from_freelist+0xfa6/0x2550
[  127.918276][ T9729]  __alloc_frozen_pages_noprof+0x227/0x520
[  127.919183][ T9729]  alloc_pages_mpol+0x218/0x560
[  127.919958][ T9729]  new_slab+0x25e/0x360
[  127.920621][ T9729]  ___slab_alloc+0xcf1/0x1610
[  127.921377][ T9729]  __slab_alloc.isra.90+0x57/0xb0
[  127.922170][ T9729]  __kmalloc_node_track_caller_noprof+0x2d1/0x510
[  127.923162][ T9729]  kmalloc_reserve+0xf1/0x2b0
[  127.923906][ T9729]  __alloc_skb+0x16e/0x370
[  127.924611][ T9729]  mld_newpack.isra.28+0x172/0xa20
[  127.925444][ T9729]  add_grhead.isra.29+0x2da/0x380
[  127.926253][ T9729]  add_grec+0x781/0x15b0
[  127.926941][ T9729]  mld_send_initial_cr.part.31+0xe3/0x260
[  127.927865][ T9729]  mld_dad_work+0x4f/0x200
[  127.928628][ T9729] page last free pid 9645 tgid 9645 stack trace:
[  127.929606][ T9729]  __free_frozen_pages+0x6dc/0xda0
[  127.930405][ T9729]  __put_partials+0x166/0x190
[  127.931146][ T9729]  qlist_free_all+0x50/0x120
[  127.931905][ T9729]  kasan_quarantine_reduce+0x163/0x1b0
[  127.932771][ T9729]  __kasan_slab_alloc+0x67/0x90
[  127.933611][ T9729]  __kmalloc_cache_noprof+0x162/0x3f0
[  127.934480][ T9729]  tomoyo_init_log+0xc74/0x1ea0
[  127.935289][ T9729]  tomoyo_supervisor+0x2f1/0x1300
[  127.936077][ T9729]  tomoyo_env_perm+0x181/0x1f0
[  127.936848][ T9729]  tomoyo_find_next_domain+0x1756/0x20b0
[  127.937840][ T9729]  tomoyo_bprm_check_security+0x130/0x1d0
[  127.939071][ T9729]  security_bprm_check+0x1b9/0x1e0
[  127.939984][ T9729]  bprm_execve+0x832/0x1640
[  127.940840][ T9729]  do_execveat_common.isra.45+0x4dc/0x610
[  127.942058][ T9729]  __x64_sys_execve+0x8e/0xb0
[  127.943004][ T9729]  do_syscall_64+0xcf/0x490
[  127.944030][ T9729] 
[  127.944606][ T9729] Memory state around the buggy address:
[  127.945621][ T9729]  ffff88804515c300: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[  127.946869][ T9729]  ffff88804515c380: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[  127.948321][ T9729] >ffff88804515c400: 00 04 fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[  127.950154][ T9729]                       ^
[  127.951126][ T9729]  ffff88804515c480: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[  127.952533][ T9729]  ffff88804515c500: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[  127.953805][ T9729] ==================================================================
[  128.007224][ T9729] Kernel panic - not syncing: KASAN: panic_on_warn set ...
[  128.008452][ T9729] CPU: 1 UID: 0 PID: 9729 Comm: syz-executor195 Not tainted 6.16.0-rc3 #1 PREEMPT(full) 
[  128.009964][ T9729] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.2-debian-1.16.2-1 04/01/2014
[  128.011626][ T9729] Call Trace:
[  128.012218][ T9729]  <TASK>
[  128.012702][ T9729]  dump_stack_lvl+0x3d/0x1b0
[  128.013488][ T9729]  panic+0x6ef/0x7a0
[  128.014166][ T9729]  ? __pfx_panic+0x10/0x10
[  128.014904][ T9729]  ? lockdep_hardirqs_on+0x8c/0x120
[  128.015744][ T9729]  ? __pfx_uni2char+0x10/0x10
[  128.016498][ T9729]  ? preempt_schedule_thunk+0x16/0x30
[  128.017404][ T9729]  ? preempt_schedule_common+0x23/0xb0
[  128.018273][ T9729]  ? check_panic_on_warn+0x1f/0xb0
[  128.019088][ T9729]  ? hfsplus_uni2asc+0x92a/0xa20
[  128.019917][ T9729]  ? __pfx_uni2char+0x10/0x10
[  128.020702][ T9729]  check_panic_on_warn+0xab/0xb0
[  128.021546][ T9729]  end_report+0x11f/0x180
[  128.022240][ T9729]  kasan_report+0xa4/0xd0
[  128.022942][ T9729]  ? hfsplus_uni2asc+0x92a/0xa20
[  128.023769][ T9729]  hfsplus_uni2asc+0x92a/0xa20
[  128.024606][ T9729]  hfsplus_readdir+0x9ba/0xfe0
[  128.025419][ T9729]  ? __pfx_hfsplus_readdir+0x10/0x10
[  128.026295][ T9729]  ? down_read_killable+0x14e/0x4e0
[  128.027177][ T9729]  ? __pfx_down_read_killable+0x10/0x10
[  128.028074][ T9729]  ? __sanitizer_cov_trace_pc+0x20/0x50
[  128.028940][ T9729]  ? common_file_perm+0x29e/0x3f0
[  128.029764][ T9729]  ? write_comp_data+0x29/0x80
[  128.030554][ T9729]  iterate_dir+0x297/0xae0
[  128.031294][ T9729]  ? __sanitizer_cov_trace_pc+0x20/0x50
[  128.032172][ T9729]  __x64_sys_getdents64+0x12f/0x2b0
[  128.033041][ T9729]  ? __pfx___x64_sys_getdents64+0x10/0x10
[  128.034031][ T9729]  ? __pfx_filldir64+0x10/0x10
[  128.034831][ T9729]  ? irqentry_exit_to_user_mode+0xae/0x290
[  128.035764][ T9729]  ? do_syscall_64+0x95/0x490
[  128.036534][ T9729]  do_syscall_64+0xcf/0x490
[  128.037393][ T9729]  entry_SYSCALL_64_after_hwframe+0x77/0x7f
[  128.038376][ T9729] RIP: 0033:0x7fe235543f19
[  128.039091][ T9729] Code: 28 00 00 00 75 05 48 83 c4 28 c3 e8 01 18 00 00 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
[  128.042136][ T9729] RSP: 002b:00007ffdb9cf8788 EFLAGS: 00000246 ORIG_RAX: 00000000000000d9
[  128.043483][ T9729] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007fe235543f19
[  128.044718][ T9729] RDX: 0000000000000400 RSI: 00002000000063c0 RDI: 0000000000000004
[  128.046026][ T9729] RBP: 00007fe2355b8510 R08: 000055558cfab4d0 R09: 000055558cfab4d0
[  128.047229][ T9729] R10: 0000000000000002 R11: 0000000000000246 R12: 00007ffdb9cf87b0
[  128.048433][ T9729] R13: 0000000000000001 R14: 431bde82d7b634db R15: 00007fe23558d03b
[  128.049676][ T9729]  </TASK>
[  128.050684][ T9729] Kernel Offset: disabled
[  128.051380][ T9729] Rebooting in 86400 seconds..

VM DIAGNOSIS:
20:57:47  Registers:
info registers vcpu 0

CPU#0
RAX=0000000000000000 RBX=0000000000000001 RCX=ffffffff81ae5f1c RDX=0000000080000002
RSI=ffff888021b39cc0 RDI=0000000000000003 RBP=ffff88807ee3ff60 RSP=ffffc9000205f788
R8 =0000000000000001 R9 =0000000000000001 R10=fffffbfff210890a R11=ffffffff90844857
R12=0000000000000003 R13=ffffed100fdc7fed R14=dffffc0000000000 R15=0000000000000001
RIP=ffffffff81ae5f1c RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 ffffffff 00c00000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 ffffffff 00c00000
FS =0000 00007f6efc3638c0 ffffffff 00c00000
GS =0000 ffff888097afa000 ffffffff 00c00000
LDT=0000 0000000000000000 ffffffff 00c00000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=000055558cfaaca8 CR3=0000000012b06000 CR4=00002ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
XMM00=ffffffffffffffff ffffffffffffffff XMM01=0000000000000000 0000000000000000
XMM02=0000000000000000 0000000000000000 XMM03=0000000000000000 0000000000000000
XMM04=00000000ff000000 0000000000000000 XMM05=ffff000000000000 ffff000000000000
XMM06=ffffffffffff0000 ff000000000000ff XMM07=0000000000000000 0000000000000000
XMM08=0000000000000110 000055971cb10102 XMM09=6464646464646464 6464646464646464
XMM10=646431f378de8d24 646431f378d59924 XMM11=0000000000000000 0000000000000000
XMM12=0000000000000000 0000000000000000 XMM13=0000000000000000 0000000000000000
XMM14=0000000000000000 0000000000000000 XMM15=0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=0000000000000000 RBX=ffffffff8d01460b RCX=ffffffff81aef262 RDX=0000000000000003
RSI=ffff8880223e5640 RDI=0000000000000002 RBP=ffffc9000617ef18 RSP=ffffc9000617ede8
R8 =ffffc9000617ee98 R9 =ffffc9000617efb8 R10=fffff52000c2fec1 R11=ffffc9000617f60a
R12=0000000000000000 R13=0000000000000012 R14=ffffc9000617efb8 R15=dffffc0000000000
RIP=ffffffff81aef46e RFL=00010046 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 ffffffff 00c00000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 ffffffff 00c00000
FS =0000 000055558cfaa380 ffffffff 00c00000
GS =0000 ffff8880eb2fa000 ffffffff 00c00000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe000004a000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000048000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00002000000063c8 CR3=0000000027ef8000 CR4=00002ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
XMM00=0000ff0000000000 00000000000000ff XMM01=66780063696e6170 3d73726f72726500
XMM02=ff00000000000000 0000000000000000 XMM03=0000000000000000 0000000000000000
XMM04=0000000000000000 00007ffdb9cf7d80 XMM05=0000000000000000 00007ffdb9cf7ec0
XMM06=00007ffdb9cf7ec0 00007ffdb9cf7d40 XMM07=00007ffdb9cf7d80 00007ffdb9cf7d60
XMM08=0000000000000000 0000000000000000 XMM09=0000000000000000 0000000000000000
XMM10=0000000000000000 0000000000000000 XMM11=0000000000000000 0000000000000000
XMM12=0000000000000000 0000000000000000 XMM13=0000000000000000 0000000000000000
XMM14=0000000000000000 0000000000000000 XMM15=0000000000000000 0000000000000000
