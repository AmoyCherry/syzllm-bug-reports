Warning: Permanently added '[localhost]:10298' (ED25519) to the list of known hosts.
executing program
syzkaller login: [  132.951750][ T9750] loop0: detected capacity change from 0 to 1024
[  132.983272][ T9750] ------------[ cut here ]------------
[  132.984338][ T9750] kernel BUG at fs/hfsplus/xattr.c:175!
[  132.997530][ T9750] Oops: invalid opcode: 0000 [#1] SMP KASAN PTI
[  132.998644][ T9750] CPU: 0 UID: 0 PID: 9750 Comm: syz-executor146 Not tainted 6.16.0-rc3 #1 PREEMPT(full) 
[  133.000148][ T9750] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.2-debian-1.16.2-1 04/01/2014
[  133.001831][ T9750] RIP: 0010:__hfsplus_setxattr+0x1bed/0x20a0
[  133.002831][ T9750] Code: 08 e8 a7 06 83 ff 48 8b 74 24 08 e9 1b ec ff ff e8 98 06 83 ff e9 f2 eb ff ff e8 8e 06 83 ff e9 9d eb ff ff e8 54 79 1c ff 90 <0f> 0b 48 8b 7c 24 40 e8 77 06 83 ff 4c 8b 44 24 30 e9 e2 ed ff ff
[  133.005788][ T9750] RSP: 0018:ffffc9000987f5a0 EFLAGS: 00010246
[  133.006767][ T9750] RAX: 0000000000000000 RBX: ffff88801f452370 RCX: ffffffff829de9d2
[  133.007958][ T9750] RDX: 0000000080000000 RSI: ffff888041f7d640 RDI: 0000000000000002
[  133.009230][ T9750] RBP: 0000000000000000 R08: ffff888021fd1000 R09: ffffed1003e8a557
[  133.010424][ T9750] R10: ffffed1003e8a556 R11: ffff88801f452ab3 R12: ffffc9000987f668
[  133.011702][ T9750] R13: ffff888029caa000 R14: 0000000000000000 R15: 1ffff9200130fec9
[  133.013043][ T9750] FS:  0000555557ed8380(0000) GS:ffff888097afa000(0000) knlGS:0000000000000000
[  133.014433][ T9750] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  133.015420][ T9750] CR2: 00007f1de11fedf8 CR3: 000000004defe000 CR4: 0000000000002ef0
[  133.016680][ T9750] Call Trace:
[  133.017217][ T9750]  <TASK>
[  133.017692][ T9750]  ? _raw_spin_unlock_irqrestore+0x41/0x70
[  133.020353][ T9750]  ? stack_depot_save_flags+0x45b/0xb30
[  133.024145][ T9750]  ? __pfx___hfsplus_setxattr+0x10/0x10
[  133.025587][ T9750]  ? hfsplus_setxattr+0x5e/0xd0
[  133.027041][ T9750]  ? __vfs_setxattr+0x175/0x1e0
[  133.028323][ T9750]  ? __vfs_setxattr_noperm+0x127/0x650
[  133.029674][ T9750]  ? __vfs_setxattr_locked+0x1d7/0x260
[  133.031038][ T9750]  ? vfs_setxattr+0x152/0x360
[  133.032306][ T9750]  ? do_setxattr+0x145/0x190
[  133.033474][ T9750]  ? filename_setxattr+0x151/0x1b0
[  133.034807][ T9750]  ? path_setxattrat+0x1bf/0x280
[  133.036018][ T9750]  ? __x64_sys_lsetxattr+0xc9/0x140
[  133.037914][ T9750]  ? do_syscall_64+0xcf/0x490
[  133.039580][ T9750]  ? entry_SYSCALL_64_after_hwframe+0x77/0x7f
[  133.041070][ T9750]  ? lockdep_unlock+0x64/0xe0
[  133.042215][ T9750]  ? __lock_acquire+0x1068/0x1f10
[  133.043466][ T9750]  ? __pfx_stack_trace_consume_entry+0x10/0x10
[  133.044960][ T9750]  ? arch_stack_walk+0x9f/0xf0
[  133.046281][ T9750]  ? kasan_save_track+0x14/0x30
[  133.047577][ T9750]  ? __kasan_kmalloc+0xaa/0xb0
[  133.049201][ T9750]  ? __kmalloc_cache_noprof+0x1cb/0x3f0
[  133.050576][ T9750]  ? hfsplus_setxattr+0x5e/0xd0
[  133.051913][ T9750]  hfsplus_setxattr+0x9b/0xd0
[  133.053134][ T9750]  ? __pfx_hfsplus_trusted_setxattr+0x10/0x10
[  133.054625][ T9750]  __vfs_setxattr+0x175/0x1e0
[  133.055760][ T9750]  ? __pfx___vfs_setxattr+0x10/0x10
[  133.057057][ T9750]  ? __sanitizer_cov_trace_pc+0x20/0x50
[  133.058624][ T9750]  __vfs_setxattr_noperm+0x127/0x650
[  133.059866][ T9750]  __vfs_setxattr_locked+0x1d7/0x260
[  133.062079][ T9750]  vfs_setxattr+0x152/0x360
[  133.063059][ T9750]  ? __pfx_vfs_setxattr+0x10/0x10
[  133.064059][ T9750]  ? find_held_lock+0x2d/0xa0
[  133.065024][ T9750]  ? mnt_get_write_access+0x52/0x300
[  133.065879][ T9750]  ? write_comp_data+0x29/0x80
[  133.066654][ T9750]  do_setxattr+0x145/0x190
[  133.067396][ T9750]  filename_setxattr+0x151/0x1b0
[  133.068218][ T9750]  ? __sanitizer_cov_trace_pc+0x20/0x50
[  133.071352][ T9750]  ? __pfx_filename_setxattr+0x10/0x10
[  133.084517][ T9750]  ? __sanitizer_cov_trace_pc+0x20/0x50
[  133.085511][ T9750]  path_setxattrat+0x1bf/0x280
[  133.086354][ T9750]  ? __pfx_path_setxattrat+0x10/0x10
[  133.087196][ T9750]  ? putname.part.25+0x124/0x160
[  133.087984][ T9750]  ? do_sys_openat2+0x486/0x6c0
[  133.088858][ T9750]  ? __pfx_do_sys_openat2+0x10/0x10
[  133.089754][ T9750]  ? do_sys_open+0xcd/0x140
[  133.090524][ T9750]  ? __pfx_do_sys_open+0x10/0x10
[  133.091346][ T9750]  ? __pfx___x64_sys_chdir+0x10/0x10
[  133.092189][ T9750]  __x64_sys_lsetxattr+0xc9/0x140
[  133.093069][ T9750]  ? lockdep_hardirqs_on+0x8c/0x120
[  133.094033][ T9750]  do_syscall_64+0xcf/0x490
[  133.094851][ T9750]  entry_SYSCALL_64_after_hwframe+0x77/0x7f
[  133.095830][ T9750] RIP: 0033:0x7f45ab398f19
[  133.096657][ T9750] Code: 28 00 00 00 75 05 48 83 c4 28 c3 e8 01 18 00 00 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
[  133.099566][ T9750] RSP: 002b:00007ffd9753be38 EFLAGS: 00000246 ORIG_RAX: 00000000000000bd
[  133.100912][ T9750] RAX: ffffffffffffffda RBX: 0000200000000080 RCX: 00007f45ab398f19
[  133.102106][ T9750] RDX: 0000000000000000 RSI: 0000200000000080 RDI: 0000200000000040
[  133.103298][ T9750] RBP: 00007f45ab40d510 R08: 0000000000000000 R09: 0000555557ed94d0
[  133.104493][ T9750] R10: 0000000000000000 R11: 0000000000000246 R12: 00007ffd9753be60
[  133.105801][ T9750] R13: 0000000000000001 R14: 431bde82d7b634db R15: 00007f45ab3e203b
[  133.107083][ T9750]  </TASK>
[  133.107592][ T9750] Modules linked in:
[  133.110685][ T9750] ---[ end trace 0000000000000000 ]---
[  133.196952][ T9750] RIP: 0010:__hfsplus_setxattr+0x1bed/0x20a0
[  133.198714][ T9750] Code: 08 e8 a7 06 83 ff 48 8b 74 24 08 e9 1b ec ff ff e8 98 06 83 ff e9 f2 eb ff ff e8 8e 06 83 ff e9 9d eb ff ff e8 54 79 1c ff 90 <0f> 0b 48 8b 7c 24 40 e8 77 06 83 ff 4c 8b 44 24 30 e9 e2 ed ff ff
[  133.208180][ T9750] RSP: 0018:ffffc9000987f5a0 EFLAGS: 00010246
[  133.210376][ T9750] RAX: 0000000000000000 RBX: ffff88801f452370 RCX: ffffffff829de9d2
[  133.212110][ T9750] RDX: 0000000080000000 RSI: ffff888041f7d640 RDI: 0000000000000002
[  133.213977][ T9750] RBP: 0000000000000000 R08: ffff888021fd1000 R09: ffffed1003e8a557
[  133.215867][ T9750] R10: ffffed1003e8a556 R11: ffff88801f452ab3 R12: ffffc9000987f668
[  133.217701][ T9750] R13: ffff888029caa000 R14: 0000000000000000 R15: 1ffff9200130fec9
[  133.219180][ T9750] FS:  0000555557ed8380(0000) GS:ffff888097afa000(0000) knlGS:0000000000000000
[  133.220996][ T9750] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  133.222228][ T9750] CR2: 000055af4d630ea8 CR3: 000000004defe000 CR4: 0000000000002ef0
[  133.223616][ T9750] Kernel panic - not syncing: Fatal exception
[  133.225087][ T9750] Kernel Offset: disabled
[  133.225954][ T9750] Rebooting in 86400 seconds..

VM DIAGNOSIS:
19:20:13  Registers:
info registers vcpu 0

CPU#0
RAX=0000000000000000 RBX=0000000000000000 RCX=0000000000000008 RDX=0000000000000000
RSI=0000000000000002 RDI=ffff8880489b4000 RBP=ffff8880489b4000 RSP=ffffc9000217f868
R8 =0000000000000c40 R9 =0000000000000001 R10=ffffed1009136070 R11=ffff8880489b0387
R12=ffffffff93b26034 R13=0000000000001938 R14=0000000000000000 R15=0000000000000001
RIP=ffffffff828c5f30 RFL=00010246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 ffffffff 00c00000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0000 0000000000000000 ffffffff 00c00000
DS =0000 0000000000000000 ffffffff 00c00000
FS =0000 00007f1de3554900 ffffffff 00c00000
GS =0000 ffff888097afa000 ffffffff 00c00000
LDT=0000 0000000000000000 ffffffff 00c00000
TR =0040 fffffe0000003000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000001000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f1de12c4958 CR3=000000004d890000 CR4=00002ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
XMM00=0000000000000000 0000000000000000 XMM01=95fd47c92e7e6499 824801a2f4137565
XMM02=00000000000f2870 ac8bc31478ec8511 XMM03=00000000000f28d8 bb585d1e59c4d4b5
XMM04=399f788f4f858bde 00000000000aef98 XMM05=117864066a3bf720 00000000000f28d8
XMM06=bb585d1e59c4d4b5 00000000000f2870 XMM07=ac8bc31478ec8511 00000000000c3b40
XMM08=8ca0b852b1c7c8e1 00000000000b04f0 XMM09=0707070707070750 5151515151685b05
XMM10=0f231100226b0707 0707070707070707 XMM11=0000000000000000 0000000000000000
XMM12=0000000000000000 0000000000000000 XMM13=0000000000000000 0000000000000000
XMM14=0000000000000000 0000000000000000 XMM15=0000000000000000 0000000000000000
info registers vcpu 1

CPU#1
RAX=000000000079d1c0 RBX=1ffff9200043de96 RCX=ffffffff8179d1c0 RDX=dffffc0000000000
RSI=0000000000000001 RDI=000000000079d1c0 RBP=0000000000000001 RSP=ffffc900021ef470
R8 =0000000000000000 R9 =0000000000000001 R10=00000000000a7cd8 R11=0000000000000001
R12=ffffc900021ef5d0 R13=ffffc900021ef5c0 R14=ffffc900021ef588 R15=ffffc900021ef5bd
RIP=ffffffff8169d2c6 RFL=00000206 [-----P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 ffffffff 00c00000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 ffffffff 00c00000
FS =0000 00007f5c14d1b8c0 ffffffff 00c00000
GS =0000 ffff8880eb2fa000 ffffffff 00c00000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe000004a000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0000048000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=000056433c57b980 CR3=000000004a946000 CR4=00002ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
XMM00=ffffffffffffffff ffffffffffffffff XMM01=0000000000000000 0000000000000000
XMM02=0000000000000000 0000000000000000 XMM03=0000000000000000 0000000000000000
XMM04=00000000ff000000 0000000000000000 XMM05=ffff000000000000 ffff000000000000
XMM06=ffffffffffff0000 ff000000000000ff XMM07=000055af4d492d40 000055af4d492d20
XMM08=0000000000000110 0000000000000000 XMM09=646431cb292cd474 646431cb2932f864
XMM10=64646464646464f5 6464646454645457 XMM11=0000000000000000 0000000000000000
XMM12=0000000000000000 0000000000000000 XMM13=0000000000000000 0000000000000000
XMM14=0000000000000000 0000000000000000 XMM15=0000000000000000 0000000000000000
